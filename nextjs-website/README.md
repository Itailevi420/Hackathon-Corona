# ðŸ“œ Next.JS Website with Contentful Blog
A website with 3 pages: Home, About and a Blog, plus auto generated pages for blog posts. Powered with the React based framework Next, and Contentful as a CMS.

## Tech Stack
- [TypeScript](https://www.typescriptlang.org/)
- [Next.JS](https://nextjs.org/)

### CMS
- [Contentful](https://www.contentful.com/)

### Performance Tests
-  [Puppeteer](https://pptr.dev/)

## Set Up
### Next.JS
If you didn't do so yet, clone the hackathon's repo:
```bash
git clone https://github.com/wonderfloyd/Hackathon-Corona.git
```
And then
```bash
cd Hackathon-Corona/nextjs-website
npm install
```

### Contentful CMS
1. Go to [Contentful's website](https://www.contentful.com/). Click the _Get Started_ button, make sure you're on the _I Build Software_ tab, click _Try For Free_ and then sign up.
2. Create a new _Space_. You should be able to find the button in the menu on the left. Call it whatever you like.
3. Install the contentful cli and login:
```bash
npm install -g contentful-cli
contentful login
```
4. Open the project folder in your favorite IDE, and open the `next.config.example.js` file. Fill in all the fields:
    - Find `spaceId` in your space's _Settings_ => _General_.
    - Find your `accessToken` in _Settings_ => _API keys_. You can use the example key generated by Conetntful or generate your own. Note that you are copying the _Content Delivery API - access token_.
    - Find your `environmentId` under _Settings_ => _Environments_.
5. Remove the `example` suffix from the config file name. _The file should be ignored by `.gitignore`_.
6. Import the contetful content model (replace `spaceId` with your space ID):
```bash
contentful --space-id [spaceId] space import --content-file contentModel.json
```
7. Go to the _Content_ tab. (Your Blog Post Content type should be selected by default). Use the _Add Blog Post_ button to add some example blog posts. Here is a nice [_Lorem Ipsum_ generator](https://loremipsum.io/). 

__That's it! you should be up and running. To run the dev server__:
```bash
npm run dev
```

To serve a production build, run
```bash
npm run build
npm start
```

## Run Performance tests
You'll need to do two things before you can run the tests:
1. Make sure you have [ts-node](https://www.npmjs.com/package/ts-node) installed and on your path.
2. Add a folder called `traces` in the `./tests` folder. _It should be ignored by .gitignore._ 

The `tests` folder includes two documented test files with example performance tests. To see what has to be done with tests visit this [issue](https://github.com/wonderfloyd/Hackathon-Corona/issues/40).  
At the moment they collect some performance metrics and the Chrome DevTools' tracing of the Home page's loading time.  
Before you run the tests, make sure you have the app served at the port specified in test files (either `3003` or `3004`).  
To run the performance metrics collection:
```bash
npm run test:perf
```

To run the loading time tracing:
```bash
npm run test:perf:trace
```

## Export content model
In order to export the content model you have got to 
And export you model:
```bash
contentful --space-id [spaceId] --skip-content true --skip-roles true --skip-webhooks true space export
```

## Contentful data model initalization - Deprecated
We used this method to create the model before using the export & import
1. On the top bar, click on the _Content model_ tab, and then click _Add content type_ on the right.
2. Name your content type _Blog Post_ and click _Create_.
3. Then, on the left you'll see a _Add field_ button. You'll have to choose a field type, and maybe some other options. Add 3 fields to the Blog Post content type:
    - Choose _Text_, then _Short text_, and name it `Title`.
    - Choose _Text_, then _Long text_, and name it `Excerpt`.
    - Choose _Text_, then _Long text_, and name it `Post Text`.
4. Click _Save_.